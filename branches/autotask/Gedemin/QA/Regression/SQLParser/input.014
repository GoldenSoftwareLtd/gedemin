select
  PC.COD_GRUCLI,
  P.COD_PESSOA,
  P.COD_RAMATI,
  P.DAT_NASCIMENTO_PESSOA,
  P.NOM_PESSOA,
  (EXTRACT (MONTH FROM P.DAT_NASCIMENTO_PESSOA))
 MES_NASCIMENTO_PESSOA,
  (EXTRACT (DAY FROM P.DAT_NASCIMENTO_PESSOA))
 DIA_NASCIMENTO_PESSOA,
  P.COD_PESSOA,
  PEGAR_DAT_SISTEMA.NUM_DIA_SISTEMA,
  PEGAR_DAT_SISTEMA.NUM_MES_SISTEMA,
  PEGAR_DAT_SISTEMA.NUM_ANO_SISTEMA
from
  PESSOAS P,
  PESSOAS_CLIENTES PC,
  PEGAR_DAT_SISTEMA
where
  (P.COD_PESSOA = PC.COD_PESSOA)
  and (
    ((:COD_PESSOA_PRM is null)
      or (P.COD_PESSOA = :COD_PESSOA_PRM))
    and ((:LOG_TODOS_GRUCLI_PRM = -1)
      or (PC.COD_GRUCLI in (:COD_GRUCLI_PRM)))
    and ((:LOG_TODOS_RAMOS_PRM = -1)
      or (P.COD_RAMATI in (:COD_RAMATI_PRM)))
    and (((:MES_ANIV_INI_PRM is null)
        and (:MES_ANIV_FIN_PRM is null))
      or ((((EXTRACT (MONTH FROM P.DAT_NASCIMENTO_PESSOA)) > :MES_ANIV_INI_PRM)
          or (((EXTRACT (MONTH FROM P.DAT_NASCIMENTO_PESSOA)) =
:MES_ANIV_INI_PRM)
            and ((EXTRACT (DAY FROM P.DAT_NASCIMENTO_PESSOA)) >=
:DIA_ANIV_INI_PRM)))
        and (((EXTRACT (MONTH FROM P.DAT_NASCIMENTO_PESSOA)) <
:MES_ANIV_FIN_PRM)
          or (((EXTRACT (MONTH FROM P.DAT_NASCIMENTO_PESSOA)) =
:MES_ANIV_FIN_PRM)
            and ((EXTRACT (DAY FROM P.DAT_NASCIMENTO_PESSOA)) <=
:DIA_ANIV_FIN_PRM)))))
  )
order by
  P.NOM_PESSOA  