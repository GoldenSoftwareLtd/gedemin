SELECT   
  D.ID,   D.PARENT,   D.DOCUMENTTYPEKEY,   D.TRTYPEKEY,   D.NUMBER,   
  D.DOCUMENTDATE,   D.DESCRIPTION,   D.DELAYED,   D.AFULL,   D.ACHAG,   D.AVIEW,   
  D.CURRKEY,   D.COMPANYKEY,   D.CREATORKEY,   D.CREATIONDATE,   D.EDITORKEY,   
  D.EDITIONDATE,   D.DISABLED,   D.RESERVED OIL.GOODKEY, OIL.DOCUMENTKEY, 
  OIL.DEPARTMENTKEY, OIL.CARDKEY, OIL.QUANTITY, OIL.SUMNCU, OIL.SUMCURR, 
  OIL.SUMEQ, C.ID, G.NAME, G.ALIAS, DEP.NAME AS DEPARTMENT 

FROM   
  gd_document d 
    RIGHT JOIN INV_P_OUTLAYINVOICELINE(:InvoiceKey, ')', 99) OIL 
      ON   (OIL.DOCUMENTKEY = D.ID) 
    LEFT JOIN INV_CARD C 
      ON   (C.ID = OIL.CARDKEY) 
    LEFT JOIN GD_GOOD G 
      ON   (G.ID = C.GOODKEY) 
    LEFT JOIN GD_CONTACT DEP ON   
      (OIL.DEPARTMENTKEY = DEP.ID)
